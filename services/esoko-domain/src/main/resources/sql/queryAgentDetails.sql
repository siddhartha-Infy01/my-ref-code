select a.first_name,a.last_name,a.town,a.country,a.people_id,a.msisdn,a.email,c.salary,c.bonus,b.location_id,(char_length(location_id) - char_length(replace(location_id,',','')) + 1) as location_count,b.commodity_id,(char_length(commodity_id) - char_length(replace(commodity_id,',','')) + 1) as commodity_count,b.template,(char_length(template) - char_length(replace(template,',','')) + 1) as template_count,b.target,b.incentive,b.bonus as bonus1,b.application_id,b.detail_id from people a,agent_details b,agent c where b.network_id=? and b.user_id=? and b.user_id=c.user_id and c.network_id=b.network_id and b.network_id=a.default_network_id and b.user_id=a.people_id  and b.record_status='A' order by application_id,first_name;